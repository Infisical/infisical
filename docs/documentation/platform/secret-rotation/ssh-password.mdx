---
title: "SSH Password Rotation"
description: "Learn how to automatically rotate SSH passwords."
---

<Note>
    Due to how SSH passwords are rotated, retired credentials will not be able to
    authenticate with the SSH provider during their [inactive period](./overview#how-rotation-works).

    This is a limitation of the SSH provider and cannot be
    rectified by Infisical.
</Note>

## Prerequisites

- Create an [SSH Connection](/integrations/app-connections/ssh) with the **Secret Rotation** requirements
- Ensure your network security policies allow incoming requests from Infisical to this rotation provider, if network restrictions apply.

## Create an SSH Password Rotation in Infisical

<Tabs>
    <Tab title="Infisical UI">
        1. Navigate to your Secret Manager Project's Dashboard and select **Add Secret Rotation** from the actions dropdown.
        ![Secret Manager Dashboard](/images/secret-rotations-v2/generic/add-secret-rotation.png)

        2. Select the **SSH Password** option.
        ![Select SSH Password](/images/secret-rotations-v2/ssh-password/select-ssh-password-option.png)

        3. Select the **SSH Connection** to use and configure the rotation behavior. Then click **Next**.
        ![Rotation Configuration](/images/secret-rotations-v2/ssh-password/ssh-password-configuration.png)

            - **SSH Connection** - the connection that will perform the rotation of the configured user's password.
            - **Rotation Interval** - the interval, in days, that once elapsed will trigger a rotation.
            - **Rotate At** - the local time of day when rotation should occur once the interval has elapsed.
            - **Auto-Rotation Enabled** - whether secrets should automatically be rotated once the rotation interval has elapsed. Disable this option to manually rotate secrets or pause secret rotation.
            <Note>
                Due to SSH Password Rotations rotating a single credential set, auto-rotation may result in service interruptions. If you need to ensure service continuity, we recommend disabling this option.
            </Note>


        4. Configure the required Parameters for your rotation. Then click **Next**.
        ![Rotation Parameters](/images/secret-rotations-v2/ssh-password/ssh-password-parameters.png)

        - **Rotation Method** - The method to use when rotating the target user's password.
            - **Login as Target** - Infisical will use the provided SSH username and password to log in and rotate its own password.
            - **Login as Root** - Infisical will use the SSH Connection's credentials to log in and rotate the provided user's password.
        - **Username** - The target SSH username whose password will be rotated.
        - **Current Password** - The current password of the target user (required when **Rotation Method** is set to **Login as Target**).
        - **Password Requirements** - The constraints to apply when generating new passwords.

        5. Specify the secret names that the SSH credentials should be mapped to. Then click **Next**.
        ![Rotation Secrets Mapping](/images/secret-rotations-v2/ssh-password/ssh-password-secrets-mapping.png)

            - **Username** - the name of the secret that the SSH username will be stored in.
            - **Password** - the name of the secret that the rotated password will be stored in.

        6. Give your rotation a name and description (optional). Then click **Next**.
        ![Rotation Details](/images/secret-rotations-v2/ssh-password/ssh-password-details.png)

            - **Name** - the name of the secret rotation configuration. Must be slug-friendly.
            - **Description** (optional) - a description of this rotation configuration.

        7. Review your configuration, then click **Create Secret Rotation**.
        ![Rotation Review](/images/secret-rotations-v2/ssh-password/ssh-password-confirm.png)

        8. Your **SSH Password** credentials are now available for use via the mapped secrets.
        ![Rotation Created](/images/secret-rotations-v2/ssh-password/ssh-password-created.png)

        ### Reconcile SSH Password

        If you suspect the credentials are out of sync (for example, after a manual password change on the server), you can regain access by using **Reconcile SSH**. This will use the configured SSH App Connection's root account to reset the target user's password and sync it with Infisical.

        ![Reconcile Option](/images/secret-rotations-v2/ssh-password/ssh-password-reconcile.png)
        ![Reconcile Confirmation](/images/secret-rotations-v2/ssh-password/ssh-password-reconcile-confirm.png)
    </Tab>
    <Tab title="API">
        To create an SSH Password Rotation, make an API request to the [Create SSH
        Password Rotation](/api-reference/endpoints/secret-rotations/ssh-password/create) API endpoint.

        ### Sample request

        ```bash Request
        curl --request POST \
        --url https://us.infisical.com/api/v2/secret-rotations/ssh-password \
        --header 'Content-Type: application/json' \
        --data '{
            "name": "my-ssh-rotation",
            "projectId": "3c90c3cc-0d44-4b50-8888-8dd25736052a",
            "description": "my ssh password rotation",
            "connectionId": "3c90c3cc-0d44-4b50-8888-8dd25736052a",
            "environment": "dev",
            "secretPath": "/",
            "isAutoRotationEnabled": false,
            "rotationInterval": 30,
            "rotateAtUtc": {
                "hours": 0,
                "minutes": 0
            },
            "parameters": {
                "rotationMethod": "login-as-root",
                "username": "appuser",
                "passwordRequirements": {
                    "length": 48,
                    "required": {
                        "digits": 2,
                        "lowercase": 2,
                        "uppercase": 2,
                        "symbols": 2
                    },
                    "allowedSymbols": "-_.~!*"
                }
            },
            "secretsMapping": {
                "username": "SSH_USERNAME",
                "password": "SSH_PASSWORD"
            }
        }'
        ```

        <Note>
            Due to SSH Password Rotations rotating a single credential set, auto-rotation may result in service interruptions. If you need to ensure service continuity, we recommend disabling this option.
        </Note>

        ### Sample response

        ```bash Response
        {
            "secretRotation": {
                "id": "3c90c3cc-0d44-4b50-8888-8dd25736052a",
                "name": "my-ssh-rotation",
                "description": "my ssh password rotation",
                "secretsMapping": {
                    "username": "SSH_USERNAME",
                    "password": "SSH_PASSWORD"
                },
                "isAutoRotationEnabled": false,
                "activeIndex": 0,
                "folderId": "3c90c3cc-0d44-4b50-8888-8dd25736052a",
                "connectionId": "3c90c3cc-0d44-4b50-8888-8dd25736052a",
                "createdAt": "2023-11-07T05:31:56Z",
                "updatedAt": "2023-11-07T05:31:56Z",
                "rotationInterval": 30,
                "rotationStatus": "success",
                "lastRotationAttemptedAt": "2023-11-07T05:31:56Z",
                "lastRotatedAt": "2023-11-07T05:31:56Z",
                "lastRotationJobId": "3c90c3cc-0d44-4b50-8888-8dd25736052a",
                "nextRotationAt": "2023-11-07T05:31:56Z",
                "connection": {
                    "app": "ssh",
                    "name": "my-ssh-connection",
                    "id": "3c90c3cc-0d44-4b50-8888-8dd25736052a"
                },
                "environment": {
                    "slug": "dev",
                    "name": "Development",
                    "id": "3c90c3cc-0d44-4b50-8888-8dd25736052a"
                },
                "projectId": "3c90c3cc-0d44-4b50-8888-8dd25736052a",
                "folder": {
                    "id": "3c90c3cc-0d44-4b50-8888-8dd25736052a",
                    "path": "/"
                },
                "rotateAtUtc": {
                    "hours": 0,
                    "minutes": 0
                },
                "lastRotationMessage": null,
                "type": "ssh-password",
                "parameters": {
                    "rotationMethod": "login-as-root",
                    "username": "appuser",
                    "passwordRequirements": {
                        "length": 48,
                        "required": {
                            "digits": 2,
                            "lowercase": 2,
                            "uppercase": 2,
                            "symbols": 2
                        },
                        "allowedSymbols": "-_.~!*"
                    }
                }
            }
        }
        ```
    </Tab>
</Tabs>
